Biostatistical Methods I - HW1
================
JingYao Geng
9/24/2020

``` r
# Clean all objects from the current workspace (R memory) 
rm(list = ls())

# load library
library(arsenal)
library(dplyr)
library(ggplot2)
library(tidyverse)
```

## Problem 1

``` r
# Import data
Antibodies = read_csv(file = "./Antibodies.csv")
```

#### 1.1.a Descriptive Statistics:

  - The **Antibodies** data set contains a total of **1491**
    observations and **5** variables.
      - **1224** missing values are founded in variable called
        **Antibody\_IgM**.
      - **34** observations of variable **Smell** are categorized as
        “Unanswered/others”.
      - The rest of variables: **Subject**, **AgeCategory**, and
        **Gender** contain no missing values.
  - The following table shows the **descriptive statistics** for all the
    variable of interest.
      - **Numeric variable: Subject, Antibody\_IgM**
      - **Categorical variable: AgeCategory, Gender, Smell**

<!-- end list -->

``` r
# Change variable names/labels
my_labels <- list(AgeCategory = "Age", Antibody_IgM = "Antibody(IgM)", Smell = "Smell", Gender = "Gender")

# Clean the output
my_controls <- tableby.control(
  total = T,
  test = F,  # No test p-values yet
  numeric.stats = c("meansd", "medianq1q3", "range", "Nmiss2"),
  cat.stats = c("countpct", "Nmiss2"), 
  stats.labels = list(
    meansd = "Mean (SD)",
    medianq1q3 = "Median (Q1, Q3)",
    range = "Min - Max",
    Nmiss2 = "Missing",
    countpct = "N (%)"))

tab1 <- tableby( ~ Subject + Antibody_IgM + AgeCategory + Smell + Gender, data = Antibodies, control = my_controls)

#Descriptive Statistics:
summary(tab1, title = "Descriptive Statistics: Antibodies Data", text = T, labelTranslations = my_labels)
```

    ## 
    ## Table: Descriptive Statistics: Antibodies Data
    ## 
    ## |                     |       Overall (N=1491)       |
    ## |:--------------------|:----------------------------:|
    ## |Subject              |                              |
    ## |-  Mean (SD)         |      1413.751 (881.073)      |
    ## |-  Median (Q1, Q3)   | 1373.000 (632.500, 2190.500) |
    ## |-  Min - Max         |       1.000 - 2917.000       |
    ## |-  Missing           |              0               |
    ## |Antibody(IgM)        |                              |
    ## |-  Mean (SD)         |        0.124 (0.110)         |
    ## |-  Median (Q1, Q3)   |     0.091 (0.069, 0.129)     |
    ## |-  Min - Max         |        0.048 - 1.048         |
    ## |-  Missing           |             1224             |
    ## |Age                  |                              |
    ## |-  18-30             |         318 (21.3%)          |
    ## |-  31-50             |         810 (54.3%)          |
    ## |-  51+               |         363 (24.3%)          |
    ## |-  Missing           |              0               |
    ## |Smell                |                              |
    ## |-  Altered           |         1047 (70.2%)         |
    ## |-  Normal            |         410 (27.5%)          |
    ## |-  Unanswered/Others |          34 (2.3%)           |
    ## |-  Missing           |              0               |
    ## |Gender               |                              |
    ## |-  Female            |         981 (65.8%)          |
    ## |-  Male              |         510 (34.2%)          |
    ## |-  Missing           |              0               |

#### 1.1.b Histogram for the Ig\_M values

The histogram of Antibody\_IgM shows a right skewed distribution, where
the mean of the Antibodies\_IgM level tends to be ‘pulled’ toward the
right tail of the distribution.

``` r
# Choose the number of bars/breaks to use for the histogram

min(Antibodies$Antibody_IgM, na.rm = TRUE) # 0.048
## [1] 0.048
max(Antibodies$Antibody_IgM, na.rm = TRUE) #1.0475
## [1] 1.0475
```

``` r
# the shape of Ig_M values looks like a reight-skewd distribution
ggplot(Antibodies, aes(x = Antibody_IgM)) +
  geom_histogram(col = "black", fill = "pink", breaks = seq(0.00,1.20, 0.02)) +                      
  #geom_vline(aes(xintercept = mean(Antibodies$Antibodies_IgM, na.rm = T)), color = "red", linetype = "dashed", size = 2) +  
  labs(title = "Histogram of Antibodies_IgM Level") +                                              
  labs(x = "Antibody IgM", y = "Count")
```

    ## Warning: Removed 1224 rows containing non-finite values (stat_bin).

![](P8130_BM_HW1_files/figure-gfm/histgram-IgM-1.png)<!-- -->

#### 1.2.a Descriptive Statistics Stratified by Smell

  - There are more observations in the Altered collection of Smell,
    regardless the variable Age, Gender, and Antibody\_IgM.
  - The normal group of Semll is more evenly distributed in gender than
    the altered group.
  - Age range 31-50 contributes more than 50% of the observations in
    both normal and altered groups.

<!-- end list -->

``` r
# filter variable 'Smell' with outcomes "Altered" and "Normal"
Antibodies_Smell = filter(Antibodies, Smell == c("Altered", "Normal"))
## Warning in Smell == c("Altered", "Normal"): longer object length is not a
## multiple of shorter object length
Antibodies_Smell
## # A tibble: 721 x 5
##    Subject AgeCategory Antibody_IgM Smell   Gender
##      <dbl> <chr>              <dbl> <chr>   <chr> 
##  1       2 18-30             NA     Normal  Female
##  2       4 31-50             NA     Normal  Male  
##  3       6 31-50              0.055 Normal  Male  
##  4       7 51+               NA     Altered Male  
##  5       8 31-50             NA     Normal  Male  
##  6       9 31-50             NA     Altered Female
##  7      10 18-30             NA     Normal  Male  
##  8      13 31-50              0.162 Altered Female
##  9      14 31-50             NA     Normal  Male  
## 10      16 31-50             NA     Normal  Female
## # ... with 711 more rows

# Tabulation by Smell categories
tab2 = tableby( Smell ~ AgeCategory + Gender + Antibody_IgM, data = Antibodies_Smell, control = my_controls)
summary(tab2, title = "Descriptive Statistics Stratified by Smell", labelTranslations = my_labels, text = T, total = F)
## 
## Table: Descriptive Statistics Stratified by Smell
## 
## |                   |   Altered (N=519)    |    Normal (N=202)    |
## |:------------------|:--------------------:|:--------------------:|
## |Age                |                      |                      |
## |-  18-30           |     117 (22.5%)      |      33 (16.3%)      |
## |-  31-50           |     278 (53.6%)      |     106 (52.5%)      |
## |-  51+             |     124 (23.9%)      |      63 (31.2%)      |
## |-  Missing         |          0           |          0           |
## |Gender             |                      |                      |
## |-  Female          |     369 (71.1%)      |     119 (58.9%)      |
## |-  Male            |     150 (28.9%)      |      83 (41.1%)      |
## |-  Missing         |          0           |          0           |
## |Antibody(IgM)      |                      |                      |
## |-  Mean (SD)       |    0.131 (0.128)     |    0.111 (0.078)     |
## |-  Median (Q1, Q3) | 0.098 (0.067, 0.139) | 0.084 (0.064, 0.121) |
## |-  Min - Max       |    0.048 - 1.048     |    0.048 - 0.465     |
## |-  Missing         |         427          |         166          |
```

#### 1.2.b Group Boxplots and Side-by-side Histogram

  - Both normal and altered boxes contain missing values.
  - The mean of normal group is slightly higher than the altered group.
  - The range of both groups are overlapped a lot.

<!-- end list -->

``` r
# A grouped boxplot
ggplot(Antibodies_Smell, aes(x = Antibody_IgM, fill = Smell)) +
  geom_boxplot(outlier.colour = "black", outlier.shape = 20,
               outlier.size = 1, notch = F) +
  scale_fill_manual(values = c("blue", "red"),            # Change colors
                    labels = expression("Normal", "Altered")) +     # Edit legend labels       
  xlab("Antibodies_IgM Level") +
  ylab("Smell Category") +
  labs(title = "Antibody (IgM) Levels based on Smell")
```

    ## Warning: Removed 593 rows containing non-finite values (stat_boxplot).

![](P8130_BM_HW1_files/figure-gfm/boxplots-1.png)<!-- -->

``` r
  theme(legend.position = "right", legend.title = element_blank())
```

    ## List of 2
    ##  $ legend.title   : list()
    ##   ..- attr(*, "class")= chr [1:2] "element_blank" "element"
    ##  $ legend.position: chr "right"
    ##  - attr(*, "class")= chr [1:2] "theme" "gg"
    ##  - attr(*, "complete")= logi FALSE
    ##  - attr(*, "validate")= logi TRUE

  - Both Altered and Normal groups display a right skewed distribution
    overall. With the increase of Antibody\_IgM level, the number of
    observations decrease for both groups.
  - There are more observations in the altered group.

<!-- end list -->

``` r
# Overlaid histograms
# Histogram of Igm by smell categories 'Normal' and 'Altered'.

ggplot(Antibodies_Smell, aes(x = Antibodies_Smell$Antibody_IgM, fill = factor(Smell))) +
  geom_histogram(binwidth = .5, alpha = .5, position = "identity", col = "black", breaks = seq(0.00,1.10,0.01)) +
  geom_vline(aes(xintercept = mean(Antibodies_Smell$Antibody_IgM, na.rm = T)), color = "red", linetype = "dashed", size = 0.5) +                   
  labs(title = "Histogram of Antibody IgM level Categorized by Smell ") +                                             
  labs(x = "Antibody_IgM Level", y = "Count") + 
  scale_fill_discrete(name = "Smell Category", labels = c("Altered", "Normal"))  
```

    ## Warning: Removed 593 rows containing non-finite values (stat_bin).

![](P8130_BM_HW1_files/figure-gfm/side%20by%20side%20histgrams-1.png)<!-- -->
